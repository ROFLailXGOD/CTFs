# One Part ! (261 points)

> One part is secure ?
nc onepart.fword.wtf 4445

При подключении мы видим следующее:
```
	Welcome to my secure Land !!! 
	Everything is in front of you !
	test it for me before publishing it 
		
you public pair : (22965905934808634619939913084489799166085253322232815259227410271986364988906219787196675728612713127788361962902469481451466832824810420618214278164818236436835232087479883045494434732867354788949773512595399061087442150116346381039840511335762080268856228247291460273310697066660124971136104559087905536238258646400357590756007925605526892991902053969595297602544912520288833754451745370373719722948761418885691054031127989161183877190435469963343632768471403624678164140192439846502238208055189465759485734937328679889759039757761613966842459843016185097672040522667205961991025795837583439902305444078052522332549, 65537)
Bonus information 
dp : 117623045039378177537726664393160866949840017693498503618609652700628873259767674159467709455967776501001724457529896041426132564892701134186581046919766755402355442541476537999710729369009249919507751784374684679166073472414502551916392722398947228072036115655007609759586936004637431025615077374805882563723
Cipher : 19291430751948873984131755589697911617649448929567595400592298165529606428602591718199483539806952993005209962650277883158252413871491419118051470129382953738110986247026839929321925004648917399209751275344201891994853046262872254950799975563867295830579445076218487530400911518890022905406933799748894797287231471848525183024375372164960718681301138146558259503032409999573801937033862544551774081705051006054840926343932440060921172614868819031910741009529411619905566452095165094097317818961753215975754925228029730323048633733769194021794209416723035317184860303269091292826442654050568424118941252362366266533969
```

Что же, очевидно. что это [RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem)) шифр. Первой идеей было попробовать разложить `n` (первая часть открытого ключа) на множители через [FactorDB](http://factordb.com/), но попытка провалилась. Что же, это было бы слишком просто. Далее на глаза попалась бонусная информация. Признаюсь честно, вначале подумал, что `dp = d * p`, но не стоит допускать мою ошибку. На самом деле это элемент [CRT](https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm) алгоритма, направленного на повышение эффективности дешифровки. Увы, сильно это ситуацию не изменило — `d` нам неизвестно, и найти что-либо не представляется возможным. Что же делать?

В таких ситуациях, обычно, обращаются к великому и могучему, т.е. к гуглу. Запрос `rsa n e dp` выводит нас на следующую станицу на [SE](https://crypto.stackexchange.com/questions/46486/rsa-given-n-e-dp-is-it-possible-to-find-d), откуда мы и узнаём заветную формулу:

![](https://latex.codecogs.com/gif.latex?%5Cgcd%28%20n%2C%20r%5E%7Be%20%5Ccdot%20d_P%7D%20-%20r%5Cbmod%20n%20%29)

В качестве `r` я выбрал 3, хотя 2 тоже сработает. Т.к. `r < n`, то

![](https://latex.codecogs.com/gif.latex?%5Cgcd%28%20n%2C%20r%5E%7Be%20%5Ccdot%20d_P%7D%20-%20r%5Cbmod%20n%20%29%3D%5Cgcd%28%20n%2C%20r%5E%7Be%20%5Ccdot%20d_P%7D%5Cbmod%20n%20-%20r%20%29)

Зная `p`, найти остальные значения и дешифровать сообщение не составляет труда. Всё, что остаётся, — это скормить все входные данные в Python. С полным кодом можно ознакомиться [тут](https://github.com/ROFLailXGOD/CTFs/tree/master/FwordCTF%202020/Crypto/One%20Part/one_part.py).

*Примечание:* при расчёте некоторых параметров используется [Modular multiplicative inverse](https://en.wikipedia.org/wiki/Modular_multiplicative_inverse) — операция, которую долгое время было принято реализовывать самостоятельно (читай — гуглить, копировать и вставлять), однако с выходом Python 3.8 эта необходимость пропала, что и продемонстрировано в скрипте.